<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Video Downloader</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f0f2f5; font-family: sans-serif; }
        .main-card { max-width: 700px; margin: 50px auto; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border: none; }
        .header { background: linear-gradient(90deg, #00C853, #B2FF59); color: white; padding: 30px; border-radius: 15px 15px 0 0; text-align: center; }
        .btn-download { background-color: #00C853; color: white; font-weight: bold; }
        .btn-download:hover { background-color: #009624; color: white; }
        #loading { display: none; }
        #result-area { display: none; margin-top: 20px; }
        .thumbnail-img { width: 100%; max-width: 300px; border-radius: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div class="card main-card">
        <div class="header">
            <h1>Video Downloader</h1>
            <p>Download video TikTok, FB, IG, YouTube Tanpa Ribet</p>
        </div>
        <div class="card-body p-4">
            
            <div class="input-group mb-3">
                <input type="text" id="urlInput" class="form-control form-control-lg" placeholder="Tempel URL video di sini...">
                <button class="btn btn-download" type="button" onclick="processVideo()">Download</button>
            </div>

            <div id="loading" class="text-center py-4">
                <div class="spinner-border text-success" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-2 text-muted">Sedang mencari video...</p>
            </div>

            <div id="result-area" class="text-center border rounded p-3 bg-light">
                <h5 id="vid-title" class="mb-3 text-dark fw-bold">Judul Video</h5>
                <img id="vid-thumb" src="" class="thumbnail-img mb-3 shadow-sm" alt="Thumbnail">
                <br>
                <p class="badge bg-secondary" id="vid-platform">Platform</p>
                <p class="text-muted small">Durasi: <span id="vid-duration"></span></p>
                
                <a id="download-btn" href="#" target="_blank" class="btn btn-success btn-lg px-5 mt-2">
                    ⬇️ Download Video (.mp4)
                </a>
                <p class="text-danger mt-2 small">*Jika video terbuka di tab baru, klik kanan pilih "Save Video As"</p>
            </div>

        </div>
    </div>
</div>

<script>
    async function processVideo() {
        const url = document.getElementById('urlInput').value;
        const loading = document.getElementById('loading');
        const resultArea = document.getElementById('result-area');

        if (!url) {
            alert("Harap masukkan URL!");
            return;
        }

        resultArea.style.display = 'none';
        loading.style.display = 'block';

        try {
            const response = await fetch('/download', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ url: url })
            });

            const data = await response.json();

            loading.style.display = 'none';

            if (data.status === 'success') {
                document.getElementById('vid-title').innerText = data.title;
                document.getElementById('vid-thumb').src = data.thumbnail;
                document.getElementById('vid-platform').innerText = data.platform;
                document.getElementById('vid-duration').innerText = data.duration;
                document.getElementById('download-btn').href = data.download_url;
                
                resultArea.style.display = 'block';
            } else {
                alert("Gagal: " + data.message);
            }

        } catch (error) {
            loading.style.display = 'none';
            alert("Terjadi kesalahan sistem.");
            console.error(error);
        }
    }
</script>

</body>
</html>
